<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interpolating irregular data • guerrilla</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Interpolating irregular data">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">guerrilla</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/irreg2.html">Interpolating irregular data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mdsumner/guerrilla">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Interpolating irregular data</h1>
                        <h4 class="author">Michael D. Sumner</h4>
            
            <h4 class="date">2019-02-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mdsumner/guerrilla/blob/master/vignettes/irreg2.Rmd"><code>vignettes/irreg2.Rmd</code></a></small>
      <div class="hidden name"><code>irreg2.Rmd</code></div>

    </div>

    
    
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<p>Define utility functions for repeated usage, and load required packages.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">scl &lt;-<span class="st"> </span><span class="cf">function</span>(x) (x <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))<span class="op">/</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/diff">diff</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/range">range</a></span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(guerrilla)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(raster)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; Loading required package: sp</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(gstat)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fields)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; Loading required package: spam</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; Loading required package: dotCall64</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt; Loading required package: grid</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; Spam version 2.2-1 (2018-12-20) is loaded.</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt; Type 'help( Spam)' or 'demo( spam)' for a short introduction </span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt; and overview of this package.</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt; Help for individual functions is also obtained by adding the</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt; suffix '.spam' to the function name, e.g. 'help( chol.spam)'.</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co">#&gt; Attaching package: 'spam'</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">#&gt;     backsolve, forwardsolve</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co">#&gt; Loading required package: maps</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt; See www.image.ucar.edu/~nychka/Fields for</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">#&gt;  a vignette and other supplements.</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(akima)</a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(palr)</a></code></pre></div>
<p>Read the zooplankton data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(readxl)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">bw &lt;-<span class="st"> </span><span class="kw"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.file">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"BW-Zooplankton_env.xls"</span>, <span class="dt">package=</span> <span class="st">"guerrilla"</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(bw[,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt;     Station            Lat              Lon            depth     </span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt;  Min.   :  4.00   Min.   :-69.11   Min.   :29.98   Min.   : 175  </span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt;  1st Qu.: 37.25   1st Qu.:-66.84   1st Qu.:40.00   1st Qu.:1523  </span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt;  Median : 60.00   Median :-65.84   Median :55.06   Median :3065  </span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt;  Mean   : 64.36   Mean   :-65.46   Mean   :54.60   Mean   :2791  </span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt;  3rd Qu.:100.25   3rd Qu.:-64.09   3rd Qu.:70.00   3rd Qu.:4114  </span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt;  Max.   :122.00   Max.   :-61.66   Max.   :80.02   Max.   :5075  </span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt;       temp              sal         chl a mg/m2)       ASC (km)      </span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt;  Min.   :-1.6712   Min.   :33.93   Min.   : 29.60   Min.   :-39.600  </span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt;  1st Qu.:-1.4726   1st Qu.:34.14   1st Qu.: 44.91   1st Qu.:  4.125  </span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt;  Median :-1.1332   Median :34.25   Median : 53.00   Median :114.950  </span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt;  Mean   :-0.6755   Mean   :34.22   Mean   : 76.80   Mean   :187.506  </span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt;  3rd Qu.: 0.1435   3rd Qu.:34.31   3rd Qu.: 85.57   3rd Qu.:330.550  </span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt;  Max.   : 0.8815   Max.   :34.42   Max.   :352.51   Max.   :775.500  </span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt;  ice free days     Total abundance   </span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt;  Min.   :-35.322   Min.   :   459.3  </span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt;  1st Qu.:  6.108   1st Qu.:  4425.9  </span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt;  Median : 33.153   Median : 11346.1  </span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#&gt;  Mean   : 33.139   Mean   : 23609.3  </span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt;  3rd Qu.: 62.901   3rd Qu.: 27417.3  </span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co">#&gt;  Max.   :101.420   Max.   :116715.8</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25">lonlat &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/as.matrix">as.matrix</a></span>(bw[, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Lon"</span>, <span class="st">"Lat"</span>)])</a>
<a class="sourceLine" id="cb2-26" data-line-number="26">val &lt;-<span class="st"> </span>bw<span class="op">$</span>temp</a>
<a class="sourceLine" id="cb2-27" data-line-number="27">minmax &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="fl">1.8</span>, <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb2-28" data-line-number="28"></a>
<a class="sourceLine" id="cb2-29" data-line-number="29">rval &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/pretty">pretty</a></span>(val, <span class="dt">n =</span> <span class="dv">15</span>)</a>
<a class="sourceLine" id="cb2-30" data-line-number="30"></a>
<a class="sourceLine" id="cb2-31" data-line-number="31">cols &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/palr/topics/sstPal">sstPal</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(rval) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<p>Plot the temperature data.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(val)</a></code></pre></div>
<p><img src="irreg2_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Create a grid to interpolate onto, this can be used repeatedly for many methods.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(raster)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">r0 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/defaultgrid.html">defaultgrid</a></span>(lonlat)</a></code></pre></div>
</div>
<div id="simplistic-rasterization" class="section level1">
<h1 class="hasAnchor">
<a href="#simplistic-rasterization" class="anchor"></a>Simplistic rasterization</h1>
<p>The most simple thing possible is to define a grid and populate that with values from points.</p>
<p>We extend the grid by a small amount, which is generally good practice.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">rasgrid &lt;-<span class="st"> </span><span class="cf">function</span>(xy, value, <span class="dt">grid =</span> <span class="ot">NULL</span>, ...) {</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">  <span class="cf">if</span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(grid)) grid &lt;-<span class="st"> </span><span class="kw"><a href="../reference/defaultgrid.html">defaultgrid</a></span>(xy)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">   <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/rasterize">rasterize</a></span>(xy, grid, <span class="dt">field =</span> value, ...)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">}</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">lastgrid &lt;-<span class="st"> </span><span class="kw">rasgrid</span>(lonlat, val, r0)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(lastgrid, <span class="dt">asp =</span> <span class="st">""</span>)</a></code></pre></div>
<p><img src="irreg2_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>The main influence on the result here is purely pixel size, and we must consider the behaviour used when there is more than one value per pixel.</p>
</div>
<div id="thin-plate-spline-interpolation-" class="section level1">
<h1 class="hasAnchor">
<a href="#thin-plate-spline-interpolation-" class="anchor"></a>Thin plate spline interpolation.</h1>
<p>This is the powerhouse behind GDAL’s raster warping, and that suggests that we could leverage GDAL by creating a data set in the right format for it to warp to.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fields)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">tpsfun &lt;-<span class="st"> </span><span class="cf">function</span>(xy, value, <span class="dt">grid =</span> <span class="ot">NULL</span>, ...) {</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  <span class="cf">if</span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(grid)) grid &lt;-<span class="st"> </span><span class="kw"><a href="../reference/defaultgrid.html">defaultgrid</a></span>(xy)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  model &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/fields/topics/Tps">Tps</a></span>(xy, value, <span class="dt">lon.lat =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/isLonLat">isLonLat</a></span>(grid), <span class="dt">method =</span> <span class="st">"REML"</span>)</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/interpolate">interpolate</a></span>(grid, model, ...)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">tpsgrid  &lt;-<span class="st"> </span><span class="kw">tpsfun</span>(lonlat, val)</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">tpsgrid &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/clamp">clamp</a></span>(tpsgrid, minmax[<span class="dv">1</span>], minmax[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb6-9" data-line-number="9"></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">## this shows the error</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11">tpsSEgrid &lt;-<span class="st"> </span><span class="kw">tpsfun</span>(lonlat, val, r0, <span class="dt">fun =</span> predictSE)</a>
<a class="sourceLine" id="cb6-12" data-line-number="12"></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(tpsgrid, <span class="dt">asp =</span> <span class="st">""</span>)</a></code></pre></div>
<p><img src="irreg2_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div id="bilinear-triangulation-" class="section level1">
<h1 class="hasAnchor">
<a href="#bilinear-triangulation-" class="anchor"></a>Bilinear triangulation.</h1>
<p>This is identical to Matlab’s griddata(, method = “bilinear”)</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(geometry)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(sp)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(guerrilla)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">trigrid &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tri_fun.html">tri_fun</a></span>(lonlat, val, r0)</a>
<a class="sourceLine" id="cb7-7" data-line-number="7"></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(trigrid, <span class="dt">asp =</span> <span class="st">""</span>)</a></code></pre></div>
<p><img src="irreg2_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div id="delaunay-and-diriclet" class="section level1">
<h1 class="hasAnchor">
<a href="#delaunay-and-diriclet" class="anchor"></a>Delaunay and Diriclet</h1>
<p>What about Delaunay and Dirichlet without interpolation?</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/dev">graphics.off</a></span>()</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">## input must be ppp</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(spatstat)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; Loading required package: spatstat.data</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; Loading required package: nlme</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; Attaching package: 'nlme'</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; The following object is masked from 'package:raster':</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt;     getData</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; Loading required package: rpart</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt; spatstat 1.58-2       (nickname: 'Not Even Wrong') </span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt; For an introduction to spatstat, type 'beginner'</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt; Attaching package: 'spatstat'</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt; The following object is masked from 'package:palr':</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt;     col2hex</span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#&gt; The following object is masked from 'package:gstat':</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="co">#&gt;     idw</span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co">#&gt; The following objects are masked from 'package:raster':</span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co">#&gt;     area, rotate, shift</span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(maptools)</a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co">#&gt; Checking rgeos availability: TRUE</span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28">rasterToOwin &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb8-29" data-line-number="29">  <span class="kw"><a href="https://www.rdocumentation.org/packages/spatstat/topics/owin">owin</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/coordinates">xmin</a></span>(x), <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/coordinates">xmax</a></span>(x)), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/coordinates">ymin</a></span>(x), <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/coordinates">ymax</a></span>(x)))</a>
<a class="sourceLine" id="cb8-30" data-line-number="30">}</a>
<a class="sourceLine" id="cb8-31" data-line-number="31">colfun &lt;-<span class="st"> </span>viridis<span class="op">::</span>viridis</a>
<a class="sourceLine" id="cb8-32" data-line-number="32">rbase &lt;-<span class="st"> </span>r0</a>
<a class="sourceLine" id="cb8-33" data-line-number="33">d &lt;-<span class="st"> </span>bw</a>
<a class="sourceLine" id="cb8-34" data-line-number="34">xname &lt;-<span class="st"> "Lon"</span></a>
<a class="sourceLine" id="cb8-35" data-line-number="35">yname &lt;-<span class="st"> "Lat"</span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36">varname &lt;-<span class="st"> "temp"</span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37">pObj &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/spatstat/topics/ppp">ppp</a></span>(d[[xname]], d[[yname]], <span class="dt">window =</span> <span class="kw">rasterToOwin</span>(rbase), <span class="dt">marks =</span> d[[varname]])</a>
<a class="sourceLine" id="cb8-38" data-line-number="38"></a>
<a class="sourceLine" id="cb8-39" data-line-number="39">lltes&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/spatstat/topics/delaunay">delaunay</a></span>(pObj)</a>
<a class="sourceLine" id="cb8-40" data-line-number="40"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-41" data-line-number="41"><span class="co">#&gt;      PLEASE </span><span class="al">NOTE</span><span class="co">:  The components "delsgs" and "summary" of the</span></a>
<a class="sourceLine" id="cb8-42" data-line-number="42"><span class="co">#&gt;  object returned by deldir() are now DATA FRAMES rather than</span></a>
<a class="sourceLine" id="cb8-43" data-line-number="43"><span class="co">#&gt;  matrices (as they were prior to release 0.0-18).</span></a>
<a class="sourceLine" id="cb8-44" data-line-number="44"><span class="co">#&gt;  See help("deldir").</span></a>
<a class="sourceLine" id="cb8-45" data-line-number="45"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb8-46" data-line-number="46"><span class="co">#&gt;      PLEASE </span><span class="al">NOTE</span><span class="co">: The process that deldir() uses for determining</span></a>
<a class="sourceLine" id="cb8-47" data-line-number="47"><span class="co">#&gt;  duplicated points has changed from that used in version</span></a>
<a class="sourceLine" id="cb8-48" data-line-number="48"><span class="co">#&gt;  0.0-9 of this package (and previously). See help("deldir").</span></a>
<a class="sourceLine" id="cb8-49" data-line-number="49">meanval &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(lltes[[<span class="dv">3</span>]]))</a>
<a class="sourceLine" id="cb8-50" data-line-number="50">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq_along</a></span>(meanval)) {</a>
<a class="sourceLine" id="cb8-51" data-line-number="51">  meanval[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/spatstat/topics/marks">marks</a></span>(pObj[lltes[[<span class="dv">3</span>]][[i]]]))</a>
<a class="sourceLine" id="cb8-52" data-line-number="52">       }</a>
<a class="sourceLine" id="cb8-53" data-line-number="53"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(<span class="kw">as</span>(lltes, <span class="st">"SpatialPolygons"</span>), <span class="dt">col =</span> <span class="kw">colfun</span>(<span class="dv">20</span>)[<span class="kw">scl</span>(meanval)<span class="op">*</span><span class="dv">19</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>], <span class="dt">asp =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb8-54" data-line-number="54"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/points">points</a></span>(d[,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(xname, yname)])</a>
<a class="sourceLine" id="cb8-55" data-line-number="55"></a>
<a class="sourceLine" id="cb8-56" data-line-number="56">lltes&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/spatstat/topics/dirichlet">dirichlet</a></span>(pObj)</a>
<a class="sourceLine" id="cb8-57" data-line-number="57">meanval &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(lltes[[<span class="dv">3</span>]]))</a>
<a class="sourceLine" id="cb8-58" data-line-number="58">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq_along</a></span>(meanval)) {</a>
<a class="sourceLine" id="cb8-59" data-line-number="59">  meanval[i] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/spatstat/topics/marks">marks</a></span>(pObj[lltes[[<span class="dv">3</span>]][[i]]]))</a>
<a class="sourceLine" id="cb8-60" data-line-number="60">  }</a>
<a class="sourceLine" id="cb8-61" data-line-number="61"></a>
<a class="sourceLine" id="cb8-62" data-line-number="62"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(<span class="kw">as</span>(lltes, <span class="st">"SpatialPolygons"</span>), <span class="dt">col =</span> <span class="kw">colfun</span>(<span class="dv">20</span>)[<span class="kw">scl</span>(meanval)<span class="op">*</span><span class="dv">19</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>], <span class="dt">asp =</span> <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb8-63" data-line-number="63"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/points">points</a></span>(d[,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(xname, yname)])</a></code></pre></div>
<p>Grid interpolation from Dirichlet or Delaunay. This is much slower than the triangulate and cart2bary method above (<strong>Mike needs to illustrate this</strong>)</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"> </a>
<a class="sourceLine" id="cb9-2" data-line-number="2"> fcs.dir &lt;-<span class="st"> </span><span class="kw"><a href="../reference/facets.html">facets</a></span>(pObj, <span class="dt">nx =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/ncell">ncol</a></span>(rbase) , <span class="dt">ny =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/ncell">nrow</a></span>(rbase), <span class="dt">method =</span> <span class="st">"dirichlet"</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt;  number of triangles = 50 </span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38,</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt; 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49,  50.</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"> <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/rasterFromXYZ">rasterFromXYZ</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/as.data.frame">as.data.frame</a></span>(fcs.dir)), <span class="dt">asp =</span> <span class="ot">NA</span>)</a></code></pre></div>
<p><img src="irreg2_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"> fcs.del &lt;-<span class="st"> </span><span class="kw"><a href="../reference/facets.html">facets</a></span>(pObj, <span class="dt">nx =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/ncell">ncol</a></span>(rbase) , <span class="dt">ny =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/ncell">nrow</a></span>(rbase), <span class="dt">method =</span> <span class="st">"delaunay"</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt;  number of triangles = 91 </span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38,</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt; 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76,</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90,  91.</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"> <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/rasterFromXYZ">rasterFromXYZ</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/as.data.frame">as.data.frame</a></span>(fcs.del)), <span class="dt">asp =</span> <span class="ot">NA</span>)</a></code></pre></div>
<p><img src="irreg2_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
</div>
<div id="idw" class="section level1">
<h1 class="hasAnchor">
<a href="#idw" class="anchor"></a>IDW</h1>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(gstat)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">idwfun &lt;-<span class="st"> </span><span class="cf">function</span>(xy, value, <span class="dt">grid =</span> <span class="ot">NULL</span>, ...) {</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">   <span class="cf">if</span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(grid)) grid &lt;-<span class="st"> </span><span class="kw"><a href="../reference/defaultgrid.html">defaultgrid</a></span>(xy)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">  d &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">lon =</span> xy[,<span class="dv">1</span>], <span class="dt">lat =</span> xy[,<span class="dv">2</span>], <span class="dt">value =</span> value)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">  <span class="kw"><a href="https://www.rdocumentation.org/packages/sp/topics/coordinates">coordinates</a></span>(d) &lt;-<span class="st"> </span><span class="er">~</span>lon<span class="op">+</span>lat</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">  <span class="kw"><a href="https://www.rdocumentation.org/packages/sp/topics/is.projected">proj4string</a></span>(d) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/sp/topics/is.projected">proj4string</a></span>(grid)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">  <span class="co">## inverse distance weighted (IDW)</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8">  mg &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/gstat/topics/gstat">gstat</a></span>(<span class="dt">id =</span> <span class="st">"value"</span>, <span class="dt">formula =</span> value<span class="op">~</span><span class="dv">1</span>, <span class="dt">locations =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"lon"</span>, <span class="st">"lat"</span>), <span class="dt">data =</span> d, ...) </a>
<a class="sourceLine" id="cb11-9" data-line-number="9">  <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/interpolate">interpolate</a></span>(grid, mg)          </a>
<a class="sourceLine" id="cb11-10" data-line-number="10">}</a>
<a class="sourceLine" id="cb11-11" data-line-number="11"></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"></a>
<a class="sourceLine" id="cb11-13" data-line-number="13">dw &lt;-<span class="st"> </span><span class="kw">idwfun</span>(lonlat, val, r0)</a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">#&gt; [inverse distance weighted interpolation]</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15">dw &lt;-<span class="st"> </span><span class="kw">idwfun</span>(lonlat, val, r0, <span class="dt">set =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">idp =</span> <span class="fl">1.5</span>))</a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="co">#&gt; [inverse distance weighted interpolation]</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(dw, <span class="dt">asp =</span> <span class="ot">NA</span>);<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/contour">contour</a></span>(trigrid, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="irreg2_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div id="kriging" class="section level1">
<h1 class="hasAnchor">
<a href="#kriging" class="anchor"></a>Kriging</h1>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">krifun &lt;-<span class="st"> </span><span class="cf">function</span>(xy, value, <span class="dt">grid =</span> <span class="ot">NULL</span>, ...) {</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">   <span class="cf">if</span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(grid)) grid &lt;-<span class="st"> </span><span class="kw"><a href="../reference/defaultgrid.html">defaultgrid</a></span>(xy)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">  d &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">lon =</span> xy[,<span class="dv">1</span>], <span class="dt">lat =</span> xy[,<span class="dv">2</span>], <span class="dt">value =</span> value)</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">  <span class="kw"><a href="https://www.rdocumentation.org/packages/sp/topics/coordinates">coordinates</a></span>(d) &lt;-<span class="st"> </span><span class="er">~</span>lon<span class="op">+</span>lat</a>
<a class="sourceLine" id="cb12-6" data-line-number="6">  <span class="kw"><a href="https://www.rdocumentation.org/packages/sp/topics/is.projected">proj4string</a></span>(d) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/sp/topics/is.projected">proj4string</a></span>(grid)</a>
<a class="sourceLine" id="cb12-7" data-line-number="7"> v &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/gstat/topics/variogram">variogram</a></span>(value<span class="op">~</span><span class="dv">1</span>, d)</a>
<a class="sourceLine" id="cb12-8" data-line-number="8"> m &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/gstat/topics/fit.variogram">fit.variogram</a></span>(v, <span class="kw"><a href="https://www.rdocumentation.org/packages/gstat/topics/vgm">vgm</a></span>(<span class="dv">1</span>, <span class="st">"Sph"</span>, <span class="dv">150</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb12-9" data-line-number="9"> gOK &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/gstat/topics/gstat">gstat</a></span>(<span class="ot">NULL</span>, <span class="st">"value"</span>, value<span class="op">~</span><span class="dv">1</span>, d, <span class="dt">model=</span>m)</a>
<a class="sourceLine" id="cb12-10" data-line-number="10"> <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/interpolate">interpolate</a></span>(grid, gOK)</a>
<a class="sourceLine" id="cb12-11" data-line-number="11"></a>
<a class="sourceLine" id="cb12-12" data-line-number="12">}</a>
<a class="sourceLine" id="cb12-13" data-line-number="13">krigrid &lt;-<span class="st"> </span><span class="kw">krifun</span>(lonlat, val, <span class="dt">grid =</span> r0)</a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt; [using ordinary kriging]</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(krigrid, <span class="dt">asp =</span> <span class="st">""</span>)</a></code></pre></div>
<p><img src="irreg2_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div id="gam" class="section level1">
<h1 class="hasAnchor">
<a href="#gam" class="anchor"></a>GAM</h1>
<p>This needs work, mgcv has more promise than this shows ;)</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(mgcv)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#&gt; This is mgcv 1.8-27. For overview type 'help("mgcv-package")'.</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt; Attaching package: 'dplyr'</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt; The following object is masked from 'package:nlme':</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">#&gt;     collapse</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">#&gt; The following objects are masked from 'package:raster':</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&gt;     intersect, select, union</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">#&gt;     filter, lag</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co">#&gt;     intersect, setdiff, setequal, union</span></a>
<a class="sourceLine" id="cb13-18" data-line-number="18">gamfit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/mgcv/topics/gam">gam</a></span>(temp <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/mgcv/topics/s">s</a></span>(Lon)<span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/mgcv/topics/s">s</a></span>(Lat), <span class="dt">data =</span> bw,<span class="dt">family =</span> gaussian, <span class="dt">method =</span> <span class="st">"REML"</span>)</a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(raster)</a>
<a class="sourceLine" id="cb13-20" data-line-number="20">g &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/raster">raster</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/extent">extent</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/as.matrix">as.matrix</a></span>(bw[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Lon"</span>, <span class="st">"Lat"</span>)])), <span class="dt">nrows =</span> <span class="dv">50</span>, <span class="dt">ncols =</span> <span class="dv">50</span>)</a>
<a class="sourceLine" id="cb13-21" data-line-number="21">pred &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/predict">predict</a></span>(gamfit, <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/as.data.frame">as.data.frame</a></span>(g, <span class="dt">xy =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="dt">Lon =</span> x, <span class="dt">Lat =</span> y) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(Lon, Lat))</a>
<a class="sourceLine" id="cb13-22" data-line-number="22"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/setValues">setValues</a></span>(g, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(pred)), <span class="dt">asp =</span> <span class="st">""</span>)</a></code></pre></div>
<p><img src="irreg2_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div id="fields" class="section level1">
<h1 class="hasAnchor">
<a href="#fields" class="anchor"></a>fields</h1>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># out &lt;- as.image(d[,varname], x = d[,c(xname, yname)], nx = 25, ny = 25)</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co"># plot(raster(out))</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co"># look&lt;- image.smooth( out, theta= 2.5) </span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co"># plot(raster(look))</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"></a>
<a class="sourceLine" id="cb14-6" data-line-number="6">fsmfun &lt;-<span class="st"> </span><span class="cf">function</span>(xy, value, <span class="dt">grid =</span> <span class="ot">NULL</span>) {</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">    <span class="cf">if</span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(grid)) grid &lt;-<span class="st"> </span><span class="kw"><a href="../reference/defaultgrid.html">defaultgrid</a></span>(xy)</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">  <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/ncell">nrow</a></span>(grid) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/ncell">ncol</a></span>(grid) <span class="co">## apparently required</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9">  out &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/fields/topics/as.image">as.image</a></span>(value, <span class="dt">x =</span> xy, <span class="dt">nx =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/ncell">nrow</a></span>(grid), <span class="dt">ny =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/ncell">ncol</a></span>(grid))</a>
<a class="sourceLine" id="cb14-10" data-line-number="10">  <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/raster">raster</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/fields/topics/image.smooth">image.smooth</a></span>( out, <span class="dt">theta=</span> <span class="fl">2.5</span>) )</a>
<a class="sourceLine" id="cb14-11" data-line-number="11">}</a>
<a class="sourceLine" id="cb14-12" data-line-number="12"></a>
<a class="sourceLine" id="cb14-13" data-line-number="13">fsmgrid &lt;-<span class="st"> </span><span class="kw">fsmfun</span>(lonlat, val, r0)</a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(fsmgrid, <span class="dt">asp =</span> <span class="st">""</span>)</a></code></pre></div>
<p><img src="irreg2_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div id="akima" class="section level1">
<h1 class="hasAnchor">
<a href="#akima" class="anchor"></a>Akima</h1>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(akima)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">akifun &lt;-<span class="st"> </span><span class="cf">function</span>(xy, value, <span class="dt">grid =</span> <span class="ot">NULL</span>, ...) {</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">     <span class="cf">if</span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(grid)) grid &lt;-<span class="st"> </span><span class="kw"><a href="../reference/defaultgrid.html">defaultgrid</a></span>(xy)</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">  x0 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/xyFromCell">xFromCol</a></span>(grid)</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">  y0 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/xyFromCell">yFromRow</a></span>(grid)</a>
<a class="sourceLine" id="cb15-6" data-line-number="6"></a>
<a class="sourceLine" id="cb15-7" data-line-number="7">  aklin &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/akima/topics/interp">interp</a></span>(xy[,<span class="dv">1</span>], xy[,<span class="dv">2</span>], value, </a>
<a class="sourceLine" id="cb15-8" data-line-number="8">              x0, y0, ...)</a>
<a class="sourceLine" id="cb15-9" data-line-number="9">  <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/raster">raster</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">x =</span> aklin<span class="op">$</span>x, <span class="dt">y =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rev">rev</a></span>(aklin<span class="op">$</span>y), <span class="dt">z =</span> aklin<span class="op">$</span>z[,<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/ncell">ncol</a></span>(aklin<span class="op">$</span>z)<span class="op">:</span><span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">}</a>
<a class="sourceLine" id="cb15-11" data-line-number="11"></a>
<a class="sourceLine" id="cb15-12" data-line-number="12">akigrid &lt;-<span class="st"> </span><span class="kw">akifun</span>(lonlat, val, <span class="dt">grid =</span> r0)</a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(akigrid, <span class="dt">asp =</span> <span class="st">""</span>)</a></code></pre></div>
<p><img src="irreg2_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div id="others" class="section level1">
<h1 class="hasAnchor">
<a href="#others" class="anchor"></a>Others</h1>
<p>Hexagons: see hexbin, spatstat.</p>
<p>sm package</p>
</div>
<div id="along-track-distance" class="section level1">
<h1 class="hasAnchor">
<a href="#along-track-distance" class="anchor"></a>Along-track distance</h1>
<p>Previously we used Latitude as our x-axis, this is not very sensible since the track visits the same latitudes at different longitudes. As a simple improvement let’s build an along-track axis.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># lonname &lt;- "Longitude [degrees_east]"</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co"># latname &lt;- "Latitude [degrees_north]"</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co"># tname &lt;- "yyyy-mm-ddThh:mm:ss.sss"</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co"># d2 &lt;- szt[asub, c(xname, yname, lonname, latname, varname, tname)]</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co"># d2$date &lt;- as.POSIXct(d2[[tname]])</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co"># d2 &lt;- d2[order(d2$date, d2$Depth), ]</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co"># library(geosphere)</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="co"># dists &lt;- numeric(nrow(d2)-1)</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="co"># for (i in seq_along(dists)) {</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="co">#   dists[i] &lt;- spDistsN1(as.matrix(d2[i, c(lonname, latname)]), as.matrix(d2[i+1, c(lonname, latname), drop = FALSE]), longlat = TRUE)</span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="co">#   }</span></a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="co"># d2$dist &lt;- cumsum(c(0, dists))</span></a></code></pre></div>
<p>So now.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># xname &lt;- "dist"</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="co"># d &lt;- d2</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co"># ex &lt;- extent(range(d[, xname]), range(d[, yname])) * 1.2</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co"># rbase &lt;- raster(ex, ncols = 25, nrows = 25)</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co"># rlast &lt;- rasterize(d[,c(xname, yname)], rbase, field = d[,varname])</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="co"># rmean &lt;- rasterize(d[,c(xname, yname)], rbase, field = d[,varname], fun = mean)</span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="co"># rval &lt;- pretty(d[,varname], n = 15)</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="co"># plot(rlast, col = colfun(length(rval) - 1), breaks = rval, asp = 1)</span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="co"># points(d[, c(xname, yname)], cex = 0.2)</span></a>
<a class="sourceLine" id="cb17-13" data-line-number="13"><span class="co">#  plot(rmean, col = colfun(length(rval) - 1), breaks = rval, asp = 1)</span></a>
<a class="sourceLine" id="cb17-14" data-line-number="14"><span class="co"># points(d[, c(xname, yname)], cex = 0.2)</span></a>
<a class="sourceLine" id="cb17-15" data-line-number="15"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-16" data-line-number="16"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-17" data-line-number="17"><span class="co"># p &lt;- Tps(d[, c(xname, yname)], d[,varname])</span></a>
<a class="sourceLine" id="cb17-18" data-line-number="18"><span class="co"># rp &lt;- interpolate(rbase, p)</span></a>
<a class="sourceLine" id="cb17-19" data-line-number="19"><span class="co"># rpse &lt;- interpolate(rbase, p, fun = predictSE)</span></a>
<a class="sourceLine" id="cb17-20" data-line-number="20"><span class="co">#  plot(rp, col = colfun(length(rval) - 1), breaks = rval, asp = 1)</span></a>
<a class="sourceLine" id="cb17-21" data-line-number="21"><span class="co"># points(d[, c(xname, yname)], cex = 0.2)</span></a>
<a class="sourceLine" id="cb17-22" data-line-number="22"><span class="co">#  plot(rpse, col = colfun(length(rval) - 1), breaks = rval, asp = 1)</span></a>
<a class="sourceLine" id="cb17-23" data-line-number="23"><span class="co"># points(d[, c(xname, yname)], cex = 0.2)</span></a>
<a class="sourceLine" id="cb17-24" data-line-number="24"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-25" data-line-number="25"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-26" data-line-number="26"><span class="co"># ## input must be ppp</span></a>
<a class="sourceLine" id="cb17-27" data-line-number="27"><span class="co"># library(spatstat)</span></a>
<a class="sourceLine" id="cb17-28" data-line-number="28"><span class="co"># library(maptools)</span></a>
<a class="sourceLine" id="cb17-29" data-line-number="29"><span class="co"># rasterToOwin &lt;- function(x) {</span></a>
<a class="sourceLine" id="cb17-30" data-line-number="30"><span class="co">#   owin(c(xmin(x), xmax(x)), c(ymin(x), ymax(x)))</span></a>
<a class="sourceLine" id="cb17-31" data-line-number="31"><span class="co"># }</span></a>
<a class="sourceLine" id="cb17-32" data-line-number="32"><span class="co"># pObj &lt;- ppp(d[,xname], d[,yname], window = rasterToOwin(rbase), marks = d[, varname])</span></a>
<a class="sourceLine" id="cb17-33" data-line-number="33"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-34" data-line-number="34"><span class="co"># lltes&lt;-delaunay(pObj)</span></a>
<a class="sourceLine" id="cb17-35" data-line-number="35"><span class="co"># meanval &lt;- numeric(length(lltes[[3]]))</span></a>
<a class="sourceLine" id="cb17-36" data-line-number="36"><span class="co">#   for (i in seq_along(meanval)) {</span></a>
<a class="sourceLine" id="cb17-37" data-line-number="37"><span class="co">#   meanval[i] &lt;- mean(marks(pObj[lltes[[3]][[i]]]))</span></a>
<a class="sourceLine" id="cb17-38" data-line-number="38"><span class="co">#        }</span></a>
<a class="sourceLine" id="cb17-39" data-line-number="39"><span class="co"># plot(as(lltes, "SpatialPolygons"), col = colfun(20)[scl(meanval)*19 + 1])</span></a>
<a class="sourceLine" id="cb17-40" data-line-number="40"><span class="co"># points(d[,c(xname, yname)])</span></a>
<a class="sourceLine" id="cb17-41" data-line-number="41"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-42" data-line-number="42"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-43" data-line-number="43"><span class="co"># lltes&lt;-dirichlet(pObj)</span></a>
<a class="sourceLine" id="cb17-44" data-line-number="44"><span class="co"># meanval &lt;- numeric(length(lltes[[3]]))</span></a>
<a class="sourceLine" id="cb17-45" data-line-number="45"><span class="co">#   for (i in seq_along(meanval)) {</span></a>
<a class="sourceLine" id="cb17-46" data-line-number="46"><span class="co">#   meanval[i] &lt;- mean(marks(pObj[lltes[[3]][[i]]]))</span></a>
<a class="sourceLine" id="cb17-47" data-line-number="47"><span class="co">#        }</span></a>
<a class="sourceLine" id="cb17-48" data-line-number="48"><span class="co"># plot(as(lltes, "SpatialPolygons"), col = colfun(20)[scl(meanval)*19 + 1])</span></a>
<a class="sourceLine" id="cb17-49" data-line-number="49"><span class="co"># points(d[,c(xname, yname)])</span></a>
<a class="sourceLine" id="cb17-50" data-line-number="50"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-51" data-line-number="51"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-52" data-line-number="52"><span class="co"># source("maybetin.R")</span></a>
<a class="sourceLine" id="cb17-53" data-line-number="53"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-54" data-line-number="54"><span class="co"># fcs.dir &lt;- facets(pObj, nx = ncol(rbase) , ny = nrow(rbase), method = "dirichlet")</span></a>
<a class="sourceLine" id="cb17-55" data-line-number="55"><span class="co"># plot(rasterFromXYZ(as.data.frame(fcs.dir)))</span></a>
<a class="sourceLine" id="cb17-56" data-line-number="56"><span class="co"># fcs.del &lt;- facets(pObj, nx = ncol(rbase) , ny = nrow(rbase), method = "delaunay")</span></a>
<a class="sourceLine" id="cb17-57" data-line-number="57"><span class="co"># plot(rasterFromXYZ(as.data.frame(fcs.del)))</span></a>
<a class="sourceLine" id="cb17-58" data-line-number="58"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-59" data-line-number="59"><span class="co"># library(gstat)</span></a>
<a class="sourceLine" id="cb17-60" data-line-number="60"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-61" data-line-number="61"><span class="co"># dsp &lt;- d</span></a>
<a class="sourceLine" id="cb17-62" data-line-number="62"><span class="co"># coordinates(dsp) &lt;- c(xname, yname)</span></a>
<a class="sourceLine" id="cb17-63" data-line-number="63"><span class="co"># ## inverse distance weighted (IDW)</span></a>
<a class="sourceLine" id="cb17-64" data-line-number="64"><span class="co"># mg &lt;- gstat(id = "Al", formula = Al~1, locations = c(xname, yname), data=dsp, </span></a>
<a class="sourceLine" id="cb17-65" data-line-number="65"><span class="co">#             nmax=7, set=list(idp = .5))</span></a>
<a class="sourceLine" id="cb17-66" data-line-number="66"><span class="co"># z &lt;- interpolate(rbase, mg)</span></a>
<a class="sourceLine" id="cb17-67" data-line-number="67"><span class="co"># plot(z)</span></a>
<a class="sourceLine" id="cb17-68" data-line-number="68"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-69" data-line-number="69"><span class="co"># ## with log</span></a>
<a class="sourceLine" id="cb17-70" data-line-number="70"><span class="co"># v &lt;- variogram(log(Al)~1, dsp)</span></a>
<a class="sourceLine" id="cb17-71" data-line-number="71"><span class="co"># m &lt;- fit.variogram(v, vgm(1, "Sph", 300, 1))</span></a>
<a class="sourceLine" id="cb17-72" data-line-number="72"><span class="co"># gOK &lt;- gstat(NULL, "logAl", log(Al)~1, dsp, model=m)</span></a>
<a class="sourceLine" id="cb17-73" data-line-number="73"><span class="co"># OK &lt;- interpolate(rbase, gOK)</span></a>
<a class="sourceLine" id="cb17-74" data-line-number="74"><span class="co"># plot(OK)</span></a>
<a class="sourceLine" id="cb17-75" data-line-number="75"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-76" data-line-number="76"><span class="co"># ## without log</span></a>
<a class="sourceLine" id="cb17-77" data-line-number="77"><span class="co"># v &lt;- variogram(Al~1, dsp)</span></a>
<a class="sourceLine" id="cb17-78" data-line-number="78"><span class="co"># m &lt;- fit.variogram(v, vgm(1, "Sph", 300, 1))</span></a>
<a class="sourceLine" id="cb17-79" data-line-number="79"><span class="co"># gOK &lt;- gstat(NULL, "Al", Al~1, dsp, model=m)</span></a>
<a class="sourceLine" id="cb17-80" data-line-number="80"><span class="co"># OK &lt;- interpolate(rbase, gOK)</span></a>
<a class="sourceLine" id="cb17-81" data-line-number="81"><span class="co"># plot(OK)</span></a>
<a class="sourceLine" id="cb17-82" data-line-number="82"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-83" data-line-number="83"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-84" data-line-number="84"><span class="co"># ## Gaussian</span></a>
<a class="sourceLine" id="cb17-85" data-line-number="85"><span class="co"># v &lt;- variogram(Al~1, dsp)</span></a>
<a class="sourceLine" id="cb17-86" data-line-number="86"><span class="co"># m &lt;- fit.variogram(v, vgm(1, "Gau", 300, 1))</span></a>
<a class="sourceLine" id="cb17-87" data-line-number="87"><span class="co"># gOK &lt;- gstat(NULL, "Al", Al~1, dsp, model=m)</span></a>
<a class="sourceLine" id="cb17-88" data-line-number="88"><span class="co"># OK &lt;- interpolate(rbase, gOK)</span></a>
<a class="sourceLine" id="cb17-89" data-line-number="89"><span class="co"># plot(OK)</span></a>
<a class="sourceLine" id="cb17-90" data-line-number="90"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-91" data-line-number="91"><span class="co"># out &lt;- as.image(d[,varname], x = d[,c(xname, yname)], nx = 25, ny = 25)</span></a>
<a class="sourceLine" id="cb17-92" data-line-number="92"><span class="co"># plot(raster(out))</span></a>
<a class="sourceLine" id="cb17-93" data-line-number="93"><span class="co"># look&lt;- image.smooth( out, theta= 2.5) </span></a>
<a class="sourceLine" id="cb17-94" data-line-number="94"><span class="co"># plot(raster(look))</span></a>
<a class="sourceLine" id="cb17-95" data-line-number="95"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-96" data-line-number="96"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-97" data-line-number="97"><span class="co"># library(akima)</span></a>
<a class="sourceLine" id="cb17-98" data-line-number="98"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-99" data-line-number="99"><span class="co"># x0 &lt;- xFromCol(rbase)</span></a>
<a class="sourceLine" id="cb17-100" data-line-number="100"><span class="co"># y0 &lt;- yFromRow(rbase)</span></a>
<a class="sourceLine" id="cb17-101" data-line-number="101"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-102" data-line-number="102"><span class="co"># aklin &lt;- interp(d[,xname], d[,yname], d[,varname], </span></a>
<a class="sourceLine" id="cb17-103" data-line-number="103"><span class="co">#               x0, y0)</span></a>
<a class="sourceLine" id="cb17-104" data-line-number="104"><span class="co"># # aksplin &lt;-interp(d[,xname], d[,yname], d[,varname], </span></a>
<a class="sourceLine" id="cb17-105" data-line-number="105"><span class="co"># #               x0, y0, linear = FALSE, extrap = TRUE) </span></a>
<a class="sourceLine" id="cb17-106" data-line-number="106"><span class="co"># rlin &lt;- raster(list(x = aklin$x, y = rev(aklin$y), z = t(aklin$z[,ncol(aklin$z):1])))</span></a>
<a class="sourceLine" id="cb17-107" data-line-number="107"><span class="co"># ##rsplin &lt;- raster(aksplin)</span></a>
<a class="sourceLine" id="cb17-108" data-line-number="108"><span class="co"># plot(rlin, col = colfun(length(rval) - 1), breaks = rval, asp = 1)</span></a>
<a class="sourceLine" id="cb17-109" data-line-number="109"><span class="co">#points(d[, c(xname, yname)], cex = 0.2)</span></a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#setup">Setup</a></li>
      <li><a href="#simplistic-rasterization">Simplistic rasterization</a></li>
      <li><a href="#thin-plate-spline-interpolation-">Thin plate spline interpolation.</a></li>
      <li><a href="#bilinear-triangulation-">Bilinear triangulation.</a></li>
      <li><a href="#delaunay-and-diriclet">Delaunay and Diriclet</a></li>
      <li><a href="#idw">IDW</a></li>
      <li><a href="#kriging">Kriging</a></li>
      <li><a href="#gam">GAM</a></li>
      <li><a href="#fields">fields</a></li>
      <li><a href="#akima">Akima</a></li>
      <li><a href="#others">Others</a></li>
      <li><a href="#along-track-distance">Along-track distance</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Michael Sumner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
